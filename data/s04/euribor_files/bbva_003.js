function updateKeyPageInfo(e,t,o){try{if("undefined"!=typeof Storage){var n=JSON.parse(sessionStorage.getItem("digitalData"));if(null!=n){for(var r in n.page.pageInfo)if(r.toLowerCase()==t.toLowerCase()){e?n.page.pageInfo[r]=o:n.page.pageInfo[r]+=o;break}sessionStorage.setItem("digitalData",JSON.stringify(n)),"undefined"!=typeof digitalChange&&digitalChange("view",n)}}}catch(e){}}function getKeyPageInfo(e){try{if("undefined"!=typeof Storage){var t=JSON.parse(sessionStorage.getItem("digitalData"));if(null!=t)for(var o in t.page.pageInfo)if(o.toLowerCase()==e.toLowerCase())return t.page.pageInfo[o]}return null}catch(e){}}define("dataLayerUtils",["bbvaUtilsUserAgent","underscore"],function(e,t){"use strict";var o=["cuenta","tarjeta","tarjetaAnticipo","prestamo","fondoInversion","seguro","deposito","fondo","producto","carteraGestionadaFondo","carteraAsesorada","carteraGestionada","sociedadSeleccionada","planPensiones"],n="",r={word:"",results:"",page:""},i={section:".contenedorEncabezadoSeccion h1",sectioncabeceraContenedor:".c-widget-cabeceraContenedor h1",menuSelected:".c-estructural-navegacionPrincipal_R2 ul li.activo",personalizado:"#personalizado",select:".gridWidget_5",quieroTexto:".js-quieroTexto",descripcionPaso:".activo .textoDescripcionPaso",tituloContenedor:".c-widget-contenedorServicing .v08 .tituloContenedor",paso:".paso h2",general:"#general",contenedorPasosH2:".contenedorPasos h2"},a="";function s(e){return"undefined"!=typeof $B&&(!(!$B||!$B[e])&&$B[e])}function c(e){var t=$("body");return t.find(e).text()?t.find(e).text():""}function u(){return c(i.sectioncabeceraContenedor)||c(i.section)||""}function d(){return"undefined"!=typeof $B&&s("tipoSegmento")?$B.tipoSegmento.toLowerCase():""}function f(){return"undefined"!=typeof $B?"PARTICULARES"===s("tipoSegmento")||"EMPRESAS"===$B.tipoSegmento?"privada":"publica":""}function g(e){var t=!1;return o.forEach(function(o){e[o]&&(n=o,(e[o].contratoDto||e[o].contrato&&e[o].contrato.contratoDto||e[o].contrato||e[o].sociedadProducto&&e[o].sociedadProducto.contratoDto)&&(t=!t))}),t}function l(e,t){return t?e[t].contratoDto||e[t].contrato&&e[t].contrato.contratoDto||e[t].contrato||e[t].sociedadProducto&&e[t].sociedadProducto.contratoDto:{}}function p(){return"undefined"!=typeof $B&&!!($B&&$B.storage&&$B.storage.session)}return{isMobile:e.isMobile,isTablet:e.isTablet,checkDevice:function(){return e.isMobile()?"movil":e.isTablet()?"tablet":"escritorio"},getGender:function(){return s("userInfoView")&&$B.userInfoView.model.hasOwnProperty("attributes")&&$B.userInfoView.model.get("sexo")?"V"===$B.userInfoView.model.get("sexo")?"masculino":"femenino":""},getState:function(){var e=this,t=s("clientResources")&&$B.clientResources.user.get("branchId")?$B.clientResources.user.get("branchId"):"";$B.tlgo.api.findById(t),$B.tlgo.api.on("searchComplete",function(t){e.state=t.codprovincia||""})},getPageName:function(e){var o=[f(),d(),c(i.section)||c(i.menuSelected),c(i.quieroTexto),c(i.descripcionPaso)];return t.filter(o,function(e){return""!==e&&null!==e&&void 0!==e}).join(":")},getPageSegment:d,getPageIntent:function(){return"undefined"==typeof $B||"particulares"!==s("tipoSegmento").toLowerCase()&&"empresas"!==$B.tipoSegmento.toLowerCase()?"":"transaccion"},getActualPage:u,checkCultureNameShort:function(){return"undefined"!=typeof $B&&s("cultureNameShort")?$B.cultureNameShort:""},checkCultureName:function(){return"undefined"!=typeof $B&&s("cultureName")?$B.cultureName.slice(-2):""},checkServer:function(){return"undefined"!=typeof $B&&s("appConfig")&&$B.appConfig.asoRestHost?$B.appConfig.asoRestHost:""},checkSegment:f,getUserSegment:function(){return"undefined"!=typeof $B&&s("userInfoView")&&$B.userInfoView.model?$B.userInfoView.model.get("tipoSegmento"):""},getEnvironment:function(){return s("environment")?$B.environment:""},getUserAge:function(){var e=s("userInfoView")&&$B.userInfoView.model.attributes.datosPersonales?t.formatDate($B.userInfoView.model.attributes.datosPersonales.fechaNacimiento,"d").slice(-4):"",o=t.formatDate(new Date,"d").slice(-4);return e&&o?(o-e).toString():""},getPageError:function(e){return a||(e&&e.model&&e.model.get("error-message")?e.model.get("error-message"):"")},getProductInfo:function(e){var t=this;if(e)return function(e){if(n&&e.hasOwnProperty(n)){var o=l(e,n);t.product.primaryCategory=o.clasificacion,t.product.productName=o.nombreComercial,t.product.productSubtype=""}}(e)},detectProduct:g,getAppVersion:function(){return $B&&$B.version?$B.version:""},showErrorMessage:function(e){var t="Data Layer Error: the module "+e+" has not loaded correctly";log().error(t,!0),log().error(t)},setSearchResults:function(e){return r.page=u(),"string"==typeof e?r.word=e:r.results=e,r},searchResults:r,cleanSearchResults:function(){r.word="",r.results="",r.page=""},setApplicationInfo:function(e){return g(e)?l(e,n):""},detectTransition:function(e){return e.el&&e.el.id&&e.el.id.indexOf("posicion")>-1||e.el&&e.el.id.indexOf("subhome")>-1||e.el&&e.el.id.indexOf("view")>=0},detect$BFirstNameSpace:s,detect$BSessionStorage:p,session$B:function(e,t,o){if("set"===e)p()&&("undefined"!=typeof $B?$B.storage.session.set(t,o):window.sessionStorage.setItem(t,o));else if(p())return"undefined"!=typeof $B?$B.storage.session.get(t):window.sessionStorage.getItem(t)},sessionWindow:function(e,t,o){if("set"!==e){var n=window.sessionStorage.getItem(t);return JSON.parse(n)}var r=JSON.stringify(o);window.sessionStorage.setItem(t,r)},getLevel2:function(){return c(i.menuSelected)||""},getLevel3:function(){return c(i.descripcionPaso)||""},getLevel4:function(){return c(i.quieroTexto)||c(i.contenedorPasosH2)||""},setTmplError:function(e){a=e},tmplError:a,cleanTmplError:function(){a=""}}});